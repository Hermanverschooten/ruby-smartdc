#!/usr/bin/env ruby

$LOAD_PATH.unshift(File.join(File.dirname(__FILE__), '..', 'lib'))
require 'cli_helper'

options = {}
OptionParser.new do |opts|
  opts.banner = "Usage: #{File.basename($0)} machine.id [options]"
  opts.on('-p', '--package NAME', 'Name of the package to use on provisioning.') {|v| options[:package] = v }
  opts.on('-h','--help') do
    puts opts
    print "\n" + 'Packages(name):'
    fixture('packages').each do |packages|
      print ' ' + packages['name']
    end
    puts
    exit
  end

  begin
    opts.parse!(ARGV)
  rescue => e
    puts e.to_s << "\n" << opts.to_s
    exit
  end
end

begin
  client.machines(ARGV[0]).resize options
rescue => e
  puts e.inspect
else
  puts "Success"  
end